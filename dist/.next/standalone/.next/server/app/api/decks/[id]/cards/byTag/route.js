"use strict";(()=>{var e={};e.id=854,e.ids=[854],e.modules={846:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1421:e=>{e.exports=require("node:child_process")},1455:e=>{e.exports=require("node:fs/promises")},1708:e=>{e.exports=require("node:process")},3024:e=>{e.exports=require("node:fs")},3033:e=>{e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:e=>{e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3873:e=>{e.exports=require("path")},4870:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},5982:(e,r,s)=>{s.r(r),s.d(r,{patchFetch:()=>x,routeModule:()=>u,serverHooks:()=>h,workAsyncStorage:()=>c,workUnitAsyncStorage:()=>l});var t={};s.r(t),s.d(t,{POST:()=>p});var a=s(6559),d=s(8088),o=s(7719),n=s(2190),i=s(5069);async function p(e,{params:r}){let{id:s}=await r;try{let{tag:r}=await e.json();if(!r)return n.NextResponse.json({message:"Tag is required"},{status:400});let t=await i.db.deck.findUnique({where:{id:s},include:{flashcards:{select:{id:!0}}}});if(!t)return n.NextResponse.json({message:"Deck not found"},{status:404});let a=await i.db.flashcard.findMany({where:{tags:{some:{name:r}}}});if(0===a.length)return n.NextResponse.json({message:"No flashcards found with the given tag"},{status:404});let d=t.flashcards.map(e=>e.id),o=a.filter(e=>!d.includes(e.id));if(0===o.length)return n.NextResponse.json({message:"All flashcards with this tag are already in the deck"},{status:400});let p=await i.db.deck.update({where:{id:s},data:{flashcards:{connect:o.map(e=>({id:e.id}))}},include:{flashcards:{include:{tags:!0}}}}),u={...p,flashcards:p.flashcards.map(e=>({...e,tags:e.tags.map(e=>e.name)}))};return n.NextResponse.json({message:`Added ${o.length} flashcards to deck`,deck:u})}catch(e){return console.error(`Error adding flashcards by tag to deck ${s}:`,e),n.NextResponse.json({message:"Failed to add flashcards to deck"},{status:500})}}let u=new a.AppRouteRouteModule({definition:{kind:d.RouteKind.APP_ROUTE,page:"/api/decks/[id]/cards/byTag/route",pathname:"/api/decks/[id]/cards/byTag",filename:"route",bundlePath:"app/api/decks/[id]/cards/byTag/route"},resolvedPagePath:"/Users/evangelosmeklis/hanzifive/src/app/api/decks/[id]/cards/byTag/route.ts",nextConfigOutput:"standalone",userland:t}),{workAsyncStorage:c,workUnitAsyncStorage:l,serverHooks:h}=u;function x(){return(0,o.patchFetch)({workAsyncStorage:c,workUnitAsyncStorage:l})}},6698:e=>{e.exports=require("node:async_hooks")},6760:e=>{e.exports=require("node:path")},7066:e=>{e.exports=require("node:tty")},7598:e=>{e.exports=require("node:crypto")},7975:e=>{e.exports=require("node:util")},8161:e=>{e.exports=require("node:os")},8474:e=>{e.exports=require("node:events")},9021:e=>{e.exports=require("fs")},9294:e=>{e.exports=require("next/dist/server/app-render/work-async-storage.external.js")}};var r=require("../../../../../../webpack-runtime.js");r.C(e);var s=e=>r(r.s=e),t=r.X(0,[447,580,33],()=>s(5982));module.exports=t})();