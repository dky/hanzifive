(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[103],{3587:(e,s,a)=>{Promise.resolve().then(a.bind(a,9827))},9827:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>j});var r=a(5155),t=a(2115),c=a(5695),n=a(1641),l=a(5731),i=a(285),d=a(6695);function o(e){let{deck:s,availableFlashcards:a,availableTags:c,onAddCard:n,onRemoveCard:l,onAddCardsByTag:o}=e,[m,x]=(0,t.useState)(""),[h,u]=(0,t.useState)(!1),[j,g]=(0,t.useState)(!1),[f,v]=(0,t.useState)(1),[y,p]=(0,t.useState)(1),[N,k]=(0,t.useState)(5);(0,t.useEffect)(()=>{v(1)},[s.flashcards.length]);let b=a.filter(e=>!s.flashcards.some(s=>s.id===e.id));(0,t.useEffect)(()=>{p(1)},[b.length]);let C=async e=>{u(!0);try{await n(e)}catch(e){console.error("Error adding card to deck:",e)}finally{u(!1)}},w=async e=>{g(!0);try{await l(e)}catch(e){console.error("Error removing card from deck:",e)}finally{g(!1)}},A=async()=>{if(m){u(!0);try{await o(m),x("")}catch(e){console.error("Error adding cards by tag:",e)}finally{u(!1)}}},S=f*N,E=s.flashcards.slice(S-N,S),P=Math.ceil(s.flashcards.length/N),$=y*N,F=b.slice($-N,$),D=Math.ceil(b.length/N);return(0,r.jsx)("div",{className:"space-y-6",children:(0,r.jsxs)(d.Zp,{children:[(0,r.jsx)(d.aR,{children:(0,r.jsxs)(d.ZB,{children:["Deck: ",s.name]})}),(0,r.jsxs)(d.Wu,{children:[(0,r.jsx)("p",{className:"text-sm text-gray-500 mb-4",children:s.description||"No description provided."}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("h3",{className:"text-lg font-medium mb-2",children:"Add Cards by Tag"}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsxs)("select",{value:m,onChange:e=>x(e.target.value),className:"flex-1 p-2 border rounded-md",children:[(0,r.jsx)("option",{value:"",children:"Select a tag"}),c.map(e=>(0,r.jsx)("option",{value:e,children:e},e))]}),(0,r.jsx)(i.$,{onClick:A,disabled:!m||h,children:h?"Adding...":"Add"})]})]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsxs)("h3",{className:"text-lg font-medium mb-2",children:["Cards in Deck (",s.flashcards.length,")"]}),0===s.flashcards.length?(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"No cards in this deck yet."}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"grid gap-2",children:E.map(e=>(0,r.jsxs)("div",{className:"flex justify-between items-center p-3 border rounded-md",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-bold",children:e.character}),(0,r.jsxs)("div",{className:"text-sm",children:[e.pinyin," - ",e.meaning]}),e.tags.length>0&&(0,r.jsx)("div",{className:"flex flex-wrap gap-1 mt-1",children:e.tags.map(e=>(0,r.jsx)("span",{className:"px-2 py-0.5 bg-gray-100 text-gray-700 rounded-full text-xs",children:e},e))})]}),(0,r.jsx)(i.$,{variant:"destructive",size:"sm",onClick:()=>w(e.id),disabled:j,children:"Remove"})]},e.id))}),P>1&&(0,r.jsxs)("div",{className:"mt-4 flex justify-center items-center gap-2",children:[(0,r.jsx)(i.$,{variant:"outline",size:"sm",onClick:()=>v(e=>Math.max(e-1,1)),disabled:1===f,children:"←"}),(0,r.jsxs)("span",{className:"text-sm",children:["Page ",f," of ",P]}),(0,r.jsx)(i.$,{variant:"outline",size:"sm",onClick:()=>v(e=>Math.min(e+1,P)),disabled:f===P,children:"→"})]}),(0,r.jsxs)("div",{className:"mt-2 flex justify-center items-center gap-2",children:[(0,r.jsx)("span",{className:"text-sm text-gray-600",children:"Cards per page:"}),(0,r.jsxs)("select",{value:N,onChange:e=>{k(Number(e.target.value)),v(1),p(1)},className:"p-1 border rounded-md text-sm",children:[(0,r.jsx)("option",{value:3,children:"3"}),(0,r.jsx)("option",{value:5,children:"5"}),(0,r.jsx)("option",{value:10,children:"10"}),(0,r.jsx)("option",{value:20,children:"20"})]})]})]})]}),b.length>0&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{className:"text-lg font-medium mb-2",children:["Available Cards to Add (",b.length,")"]}),(0,r.jsx)("div",{className:"grid gap-2",children:F.map(e=>(0,r.jsxs)("div",{className:"flex justify-between items-center p-3 border rounded-md",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-bold",children:e.character}),(0,r.jsxs)("div",{className:"text-sm",children:[e.pinyin," - ",e.meaning]}),e.tags.length>0&&(0,r.jsx)("div",{className:"flex flex-wrap gap-1 mt-1",children:e.tags.map(e=>(0,r.jsx)("span",{className:"px-2 py-0.5 bg-gray-100 text-gray-700 rounded-full text-xs",children:e},e))})]}),(0,r.jsx)(i.$,{variant:"outline",size:"sm",onClick:()=>C(e.id),disabled:h,children:"Add"})]},e.id))}),D>1&&(0,r.jsxs)("div",{className:"mt-4 flex justify-center items-center gap-2",children:[(0,r.jsx)(i.$,{variant:"outline",size:"sm",onClick:()=>p(e=>Math.max(e-1,1)),disabled:1===y,children:"←"}),(0,r.jsxs)("span",{className:"text-sm",children:["Page ",y," of ",D]}),(0,r.jsx)(i.$,{variant:"outline",size:"sm",onClick:()=>p(e=>Math.min(e+1,D)),disabled:y===D,children:"→"})]})]})]})]})})}var m=a(7300),x=a(6874),h=a.n(x),u=a(3568);function j(){let e=(0,c.useParams)();(0,c.useRouter)();let s=e.id,[a,d]=(0,t.useState)(null),[x,j]=(0,t.useState)([]),[g,f]=(0,t.useState)([]),[v,y]=(0,t.useState)(!0),[p,N]=(0,t.useState)(null),[k,b]=(0,t.useState)(!1),[C,w]=(0,t.useState)(!1);(0,t.useEffect)(()=>{A()},[s]);let A=async()=>{y(!0);try{let[e,a,r]=await Promise.all([(0,l.k2)(s),(0,l.sy)(),(0,l.Q2)()]);d(e),j(a),f(r.map(e=>e.name)),N(null)}catch(e){console.error("Error loading data:",e),N("Failed to load data. Please try again later.")}finally{y(!1)}},S=async e=>{try{return await (0,l.aP)(s,e),u.Ay.success("Card added to deck"),await A(),Promise.resolve()}catch(e){return console.error("Error adding card to deck:",e),u.Ay.error("Failed to add card to deck"),Promise.reject(e)}},E=async e=>{try{return await (0,l.qF)(s,e),u.Ay.success("Card removed from deck"),await A(),Promise.resolve()}catch(e){return console.error("Error removing card from deck:",e),u.Ay.error("Failed to remove card from deck"),Promise.reject(e)}},P=async e=>{try{let a=await (0,l.gW)(s,e);return u.Ay.success(a.message),await A(),Promise.resolve()}catch(e){return console.error("Error adding cards by tag:",e),u.Ay.error("Failed to add cards by tag"),Promise.reject(e)}},$=async(e,s)=>{w(!0);try{console.log("Attempting to rename deck ".concat(e,' to "').concat(s,'"'));let a=await (0,l.Xj)(e,{name:s});return console.log("Rename success:",a),u.Ay.success("Deck renamed successfully"),await A(),Promise.resolve()}catch(e){return console.error("Error renaming deck:",e),e instanceof Error?u.Ay.error("Failed to rename deck: ".concat(e.message)):u.Ay.error("Failed to rename deck"),Promise.reject(e)}finally{w(!1)}};return v?(0,r.jsx)(n.$,{children:(0,r.jsx)("div",{className:"container mx-auto px-4 py-8 text-center",children:"Loading deck information..."})}):p||!a?(0,r.jsx)(n.$,{children:(0,r.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,r.jsx)("div",{className:"text-center text-red-500 mb-4",children:p||"Deck not found"}),(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)(h(),{href:"/decks",children:(0,r.jsx)(i.$,{children:"Go back to decks"})})})]})}):(0,r.jsx)(n.$,{children:(0,r.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsxs)("h1",{className:"text-2xl font-bold",children:["Manage Deck: ",a.name]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(i.$,{variant:"outline",onClick:()=>b(!0),children:"Rename"}),(0,r.jsx)(h(),{href:"/decks",children:(0,r.jsx)(i.$,{variant:"outline",children:"Back to Decks"})}),(0,r.jsx)(h(),{href:"/decks/".concat(s,"/history"),children:(0,r.jsx)(i.$,{variant:"outline",children:"Study History"})}),(0,r.jsx)(h(),{href:"/study/".concat(s),children:(0,r.jsx)(i.$,{children:"Study Deck"})})]})]}),(0,r.jsx)(o,{deck:a,availableFlashcards:x,availableTags:g,onAddCard:S,onRemoveCard:E,onAddCardsByTag:P}),a&&(0,r.jsx)(m.N,{deckId:s,currentName:a.name,isOpen:k,onClose:()=>b(!1),onRename:$})]})})}}},e=>{var s=s=>e(e.s=s);e.O(0,[37,381,568,961,756,940,441,684,358],()=>s(3587)),_N_E=e.O()}]);